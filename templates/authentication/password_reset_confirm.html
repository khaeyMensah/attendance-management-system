{% extends "base_accounts.html" %}
{% load widget_tweaks %}
{% block title %}{% if validlink %}Set New Password - ClassMark{% else %}Invalid Reset Link - ClassMark{% endif %}{% endblock %}

{% block content %}
{% if validlink %}
  <h2 class="mb-2 text-2xl font-semibold text-slate-900">Set a new password</h2>
  <p class="mb-6 text-sm text-slate-600">Choose a strong password for your account.</p>

  {% if form.non_field_errors %}
    <div class="auth-message auth-message-error mb-4">{{ form.non_field_errors }}</div>
  {% endif %}

  <form method="post" class="space-y-4" novalidate>
    {% csrf_token %}
    {% for field in form %}
      <div>
        <label for="{{ field.id_for_label }}" class="block mb-1 text-sm font-medium text-slate-700">{{ field.label }}</label>
        {% if field.errors %}
          <div class="auth-error-list">{{ field.errors }}</div>
          {{ field|add_class:"auth-input auth-input-error" }}
        {% else %}
          {{ field|add_class:"auth-input" }}
        {% endif %}
        {% if field.help_text %}<p class="auth-help">{{ field.help_text }}</p>{% endif %}
      </div>
    {% endfor %}

    <button type="submit" class="w-full px-4 py-2.5 text-white rounded-lg bg-emerald-600 hover:bg-emerald-700">
      Change password
    </button>
  </form>
{% else %}
  <h2 class="mb-2 text-2xl font-semibold text-slate-900">Invalid reset link</h2>
  <div class="auth-message auth-message-error mb-4">The password reset link is invalid or has expired.</div>
  <div class="space-y-3">
    <a href="{% url 'users:password_reset' %}" class="inline-block w-full px-4 py-2.5 text-center text-white rounded-lg bg-indigo-600 hover:bg-indigo-700">Request a new reset link</a>
    <a href="{% url 'users:login' %}" class="inline-block w-full px-4 py-2.5 text-center text-slate-700 bg-slate-100 rounded-lg hover:bg-slate-200">Return to login</a>
  </div>
{% endif %}
{% endblock %}
